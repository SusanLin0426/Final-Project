# Term Structure Construction and Ho-Lee Model Calibration

This project provides a comprehensive implementation of term structure construction and the calibration of the Ho-Lee model for pricing european call option on bond. It includes C++ code for the core logic and a Python script for generating initial data using cubic spline interpolation. Additionally, an HTTP server is implemented to handle user requests and perform the necessary calculations. The project also includes a front-end interface built with React for ease of use.

## Project Structure

The project consists of the following main components:

1. **Term Structure Implementation**:
   - `TermStructure.h` and `TermStructure.cpp`: Defines the base `TermStructure` class and derived classes for flat and interpolated term structures.
   - `TermStructureHoLee.h` and `TermStructureHoLee.cpp`: Implements the Ho-Lee model for term structure. The parameters are calibrated by Levenberg-Marquardt algorithm with zero coupon bond data.

2. **Time-Contingent Cash Flows**:
   - `TimeContingentCashFlows.h` and `TimeContingentCashFlows.cpp`: Manages cash flows that are contingent on time.

3. **HTTP Server**:
   - `main.cpp`: Implements an HTTP server using the `httplib` and `json` libraries to handle requests for bond pricing calculations.
   - `httplib.h`: Header file for the HTTP server library.
   - `json.hpp`: Header file for JSON parsing and handling.

4. **Date Handling**:
   - `date.h` and `date.cpp`: Provides utilities for date manipulation and day count conventions.

5. **Data Preparation**:
   - `cubic.py`: Python script to generate initial term structure data using cubic spline interpolation.
   - `cubic.csv`: CSV file containing sample data for cubic spline interpolation.
   - `maturity_days_and_rates.csv`: CSV file generated by the Python script containing maturity days and corresponding rates.

6. **Front-end Interface**:
   - Built with React to provide an intuitive user interface for interacting with the server and visualizing results.

### Using C++ Headers

- `httplib.h` from [cpp-httplib](https://github.com/yhirose/cpp-httplib)
- `json.hpp` from [json](https://github.com/nlohmann/json)

Note: You can use these functions by including these headers in your directory.

## How to Build and Run

### Prerequisites

- C++ compiler (e.g., g++)
- Python 3.x with necessary libraries (`numpy`, `pandas`, `scipy`, `matplotlib`)
- Make utility
- Node.js and npm for the front-end

### Building the C++ Project

1. **Compile the Code**:
   Use the provided `Makefile` to compile the C++ code. Run the following command in the project directory:
   ```bash
   make
   ```

2. **Run the Executable**:
   After compilation, run the generated executable:
   ```bash
   ./final
   ```

### Running the Python Script

1. **Install Python Dependencies**:
   Ensure you have the required Python libraries installed. You can use `pip` to install them:
   ```bash
   pip install numpy pandas scipy matplotlib
   ```

2. **Generate Term Structure Data**:
   Run the Python script to generate the `maturity_days_and_rates.csv` file:
   ```bash
   python cubic.py
   ```

### Starting the HTTP Server

The HTTP server listens for POST requests at the `/calculate` endpoint. It expects a JSON payload with the following parameters:

- `k`: Strike price
- `maturity_date`: Maturity date in the format `YYYY-MM-DD`
- `delta`: Initial delta parameter for the Ho-Lee model
- `pi`: Initial pi parameter for the Ho-Lee model
- `coupon_rate`: Coupon rate of the bond
- `face_value`: Face value of the bond
- `day_count_convention`: Day count convention for calculating the time to maturity

Example JSON payload:
```json
{
  "k": 100,
  "maturity_date": "2030-01-01",
  "delta": 0.98,
  "pi": 0.5,
  "coupon_rate": 0.05,
  "face_value": 1000,
  "day_count_convention": {"value": "Actual365"}
}
```

### Front-end

1. **Navigate to the Front-end Directory**:
   Move to the front-end directory and run the following command:
   ```bash
   npm start
   ```

2. **Interface**:
   The front-end interface provides a user-friendly way to interact with the back-end server and visualize the results.

![image](https://github.com/NTUFA-2024-Final-Project/Final-Project/assets/79501315/1a3e0c9e-06e4-4e1a-ae75-b56bef1803f3)

### Usage

1. **Start the HTTP Server**:
   The server starts automatically when you run the compiled executable.

2. **Send Calculation Requests**:
   Use a tool like `curl` or Postman to send POST requests to the server. Example using `curl`:
   ```bash
   curl -X POST http://localhost:3001/calculate -H "Content-Type: application/json" -d @payload.json
   ```

### Note

- The cubic spline interpolation data (`cubic.csv`) should be uploaded by the user via the user interface. However, this feature has not been implemented due to technical issues.
- The project includes comprehensive logging and error handling to ensure smooth operation and easy debugging.

## Conclusion

This project provides a robust framework for constructing term structures and calibrating the Ho-Lee model. It leverages both C++ for high-performance calculations and Python for flexible data manipulation and visualization. The HTTP server interface and the React-based front-end make it easy to integrate with other systems and applications.

